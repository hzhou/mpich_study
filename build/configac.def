include: build/ac_mpich.def

macros:
    Package: MPICH
    Version: MPICH_VERSION_m4
    BugReport: discuss@mpich.org
    TarName: mpich
    URL: http://www.mpich.org/

    # silent-rules is default as v1.13
    # foreign style, the default is gnu, which demands NEWS,...etc.
    # subdir-objects, cd before compile (foo_SOURCES=src/sub/foo.c)
    AM_OPT: -Wall -Wno-portability-recursive foreign silent-rules subdir-objects

page: t.ac, mpich_ac_frame
    module: sh

    FROM_MPICH=yes
    export FROM_MPICH

    PAC_PREFIX_ALL_FLAGS(USER)
    PAC_PREFIX_ALL_FLAGS(WRAPPER)
    $call @set_CFLAGS
    m4_ifdef([AM_SILENT_RULES], [AM_SILENT_RULES([yes])])

    PAC_ARG_CACHING
    PAC_ARG_STRICT
    PAC_VPATH_CHECK(src/include/mpi.h src/env/mpicc,lib)

    $call @default_library_names
    AC_LANG_C
    AC_PATH_PROG(PERL,perl)
    $map check_progs, ar, ranlib, killall, xargs, install, mkdir, make
    AC_PATH_PROG(BASH_SHELL,bash)

    $call @check_debuggerlib
    $call @check_nameserv
    $call @check_const_volatile_restrict_inline_etc
    $call @check_long_double_long_long
    $call @check_struct_alignment
    $call @check_c_types # lengthy
    PAC_ENABLE_COVERAGE
    $call @check_headers
    $call @set_MPI_AINT
    $call @check_checkpointing
    PAC_CREATE_BASE_CACHE
    $call @configure_device
    $call @check_MISC

#----------------------------------------------- 
# ./configure --with-device=ch4:ofi  
# find src -name subconfigure.m4
# find src -name configure
subcode: subconfig
    m4_map([PAC_SUBCFG_CONFIGURE_SUBSYS],[PAC_SUBCFG_MODULE_LIST])
    for subsys in $devsubsystems $subsystems ; do
        PAC_CONFIG_SUBDIR([$subsys],[],[AC_MSG_ERROR([$subsys configure failed])])

