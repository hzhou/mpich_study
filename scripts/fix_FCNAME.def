include: macros/patch.def

page: t, patch_frame
    module: perl
    # patch: FCNAME
    patch: FCNAME_defs

#---------------------------------------- 
subcode: grep_FCNAME
    $call grep_cmd, grep FCNAME | grep -v ':#'
    my %files
    &call open_r, $grep_cmd |
        $if /^\.\/(src\S*):/
            $files{$1}++

    my @files = sort keys %files

subcode: filter_lines_FCNAME
    $if $(l)=~/FCNAME/ && $(l)!~/#(define|undef)/
        $(l)=~s/FCNAME/__func__/g
        $cnt++

#---------------------------------------- 
subcode: grep_FCNAME_defs
    $call grep_l, 'FCNAME\\|FUNCNAME'
    push @files, "maint/extractcvars.in"
    push @files, "src/binding/fortran/mpif_h/buildiface"

subcode: filter_lines_FCNAME_defs
    $if $(l)=~/^#(define|undef)\s+(FCNAME|FUNCNAME)/
        $call delete, $(l)
        $cnt++
        next
