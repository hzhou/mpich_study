subcode: prepare_testing
    my $dir = "test/mpi"
    my $srcdir="../.."
    chdir $dir or die "Can't chdir $dir\n"
    $if !-d "mymake"
        mkdir "mymake" or die "Can't mkdir mymake\n"

    $call @testing_config
    system "cp Makefile mymake/Makefile.orig"

subcode: add_rule_testing
    push @extra_make_rules, ".PHONY: testing"
    push @extra_make_rules, "testing:"
    push @extra_make_rules, "\t\x24(DO_testing)"
    push @extra_make_rules, ""

# --------------------------------
subcode: testing_config
    system "rsync -r $srcdir/confdb/ confdb/"
    system "cp $srcdir/maint/version.m4 ."
    system "sh autogen.sh"
    system "autoreconf -ivf"
    system "./configure"
